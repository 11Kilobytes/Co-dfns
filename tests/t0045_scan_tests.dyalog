:Require file://t0045.dyalog
:Namespace t0045_tests

 tn←'t0045' ⋄ cn←'c0045'
 cd←⎕NS⍬ ⋄ dy←#.⍎tn

 ∆00_TEST←{#.UT.expect←0
  _←#.⎕EX cn ⋄ 0⊣cd∘←#.c0045←tn #.codfns.Fix ⎕SRC dy}

 MK∆T1←{##.UT.expect←(⍎'dy.',⍺⍺)⍵⍵ ⋄ (⍎'cd.',⍺⍺)⍵⍵}
 MK∆T2←{##.UT.expect←⊃(⍎'dy.',⍺⍺)/⍵⍵ ⋄ ⊃(⍎'cd.',⍺⍺)/⍵⍵}
 MK∆T3←{fn tl←⍺⍺ ⋄ nv←⊃(⍎'dy.',fn)/⍵⍵ ⋄ cv←⊃(⍎'cd.',fn)/⍵⍵
  ##.UT.expect←(≢,nv)⍴1 ⋄ ,tl>|nv-cv}

 X←⍉⍪¯35.5 ¯41.5 ¯29.5 7.5 34.5 ¯11.5 31.5 ¯0.5 32.5 12.5
 I←{⍬≡⍴⍵:⍵ ⋄ ⊃((⎕DR ⍵)323)⎕DR ⍵}¯5000+?100⍴10000
 F←100÷⍨?100⍴10000
 B←?100⍴2

∆scan∆001_TEST←'scan∆R1' MK∆T1 (⍬⍴1)
∆scan∆002_TEST←'scan∆R1' MK∆T1 (?5⍴2)
∆scan∆003_TEST←'scan∆R1' MK∆T1 (5⍴⍳5)
∆scan∆004_TEST←'scan∆R1' MK∆T1 ((2*16)+?5⍴128)
∆scan∆005_TEST←'scan∆R1' MK∆T1 (?5⍴0)
∆scan∆006_TEST←'scan∆R1' MK∆T1 ((?5⍴0)+0j1×?5⍴0)
∆scan∆007_TEST←'scan∆R1' MK∆T1 (?2048⍴2)
∆scan∆008_TEST←'scan∆R1' MK∆T1 (2048⍴⍳5)
∆scan∆009_TEST←'scan∆R1' MK∆T1 ((2*16)+?2048⍴128)
∆scan∆010_TEST←'scan∆R1' MK∆T1 (?2048⍴0)
∆scan∆011_TEST←'scan∆R1' MK∆T1 ((?2048⍴0)+0j1×?2048⍴0)
∆scan∆012_TEST←'scan∆R1' MK∆T1 ((2*18)⍴2 0 0 0 0)
∆scan∆013_TEST←'scan∆R1' MK∆T1 (?3 3⍴2)
∆scan∆014_TEST←'scan∆R1' MK∆T1 ((2*8)+?3 3⍴128)
∆scan∆015_TEST←'scan∆R1' MK∆T1 ((2*16)+?3 3⍴128)
∆scan∆016_TEST←'scan∆R1' MK∆T1 (?3 3⍴0)
∆scan∆017_TEST←'scan∆R1' MK∆T1 ((?3 3⍴0)+0j1+?3 3⍴0)
∆scan∆018_TEST←'scan∆R1' MK∆T1 (?64 64⍴2)
∆scan∆019_TEST←'scan∆R1' MK∆T1 ((2*8)+?64 64⍴128)
∆scan∆020_TEST←'scan∆R1' MK∆T1 ((2*16)+?64 64⍴128)
∆scan∆021_TEST←'scan∆R1' MK∆T1 (?64 64⍴0)
∆scan∆022_TEST←'scan∆R1' MK∆T1 ((?64 64⍴0)+0j1+?64 64⍴0)
∆scan∆023_TEST←'scan∆R1' MK∆T1 (?3 3 3⍴2)
∆scan∆024_TEST←'scan∆R1' MK∆T1 ((2*8)+?3 3 3⍴128)
∆scan∆025_TEST←'scan∆R1' MK∆T1 ((2*16)+?3 3 3⍴128)
∆scan∆026_TEST←'scan∆R1' MK∆T1 (?3 3 3⍴0)
∆scan∆027_TEST←'scan∆R1' MK∆T1 ((?3 3 3⍴0)+0j1+?3 3 3⍴0)
∆scan∆028_TEST←'scan∆R1' MK∆T1 (?16 16 16⍴2)
∆scan∆029_TEST←'scan∆R1' MK∆T1 ((2*8)+?16 16 16⍴128)
∆scan∆030_TEST←'scan∆R1' MK∆T1 ((2*16)+?16 16 16⍴128)
∆scan∆031_TEST←'scan∆R1' MK∆T1 (?16 16 16⍴0)
∆scan∆032_TEST←'scan∆R1' MK∆T1 ((?16 16 16⍴0)+0j1+?16 16 16⍴0)
∆scan∆033_TEST←'scan∆R2' MK∆T1 (⍬⍴1)
∆scan∆034_TEST←'scan∆R2' MK∆T1 (?5⍴2)
∆scan∆035_TEST←'scan∆R2' MK∆T1 (5⍴⍳5)
∆scan∆036_TEST←'scan∆R2' MK∆T1 ((2*16)+?5⍴128)
∆scan∆037_TEST←'scan∆R2' MK∆T1 (?5⍴0)
∆scan∆038_TEST←'scan∆R2' MK∆T1 ((?5⍴0)+0j1×?5⍴0)
∆scan∆039_TEST←'scan∆R2' MK∆T1 (?2048⍴2)
∆scan∆040_TEST←'scan∆R2' MK∆T1 (2048⍴⍳5)
∆scan∆041_TEST←'scan∆R2' MK∆T1 ((2*16),1+?1500⍴2)
∆scan∆042_TEST←'scan∆R2' MK∆T1 (?2048⍴0)
∆scan∆043_TEST←'scan∆R2' MK∆T1 ((?2048⍴0)+0j1×?2048⍴0)
∆scan∆044_TEST←'scan∆R2' MK∆T1 (?3 3⍴2)
∆scan∆045_TEST←'scan∆R2' MK∆T1 ((2*8)+1+?3 3⍴2)
∆scan∆046_TEST←'scan∆R2' MK∆T1 ((2*16)+1+?3 3⍴2)
∆scan∆047_TEST←'scan∆R2' MK∆T1 (?3 3⍴0)
∆scan∆048_TEST←'scan∆R2' MK∆T1 ((?3 3⍴0)+0j1+?3 3⍴0)
∆scan∆049_TEST←'scan∆R2' MK∆T1 (?64 64⍴2)
∆scan∆050_TEST←'scan∆R2' MK∆T1 ((2*8)+1+?64 64⍴2)
∆scan∆051_TEST←'scan∆R2' MK∆T1 ((2*16),1+?64 64⍴2)
∆scan∆052_TEST←'scan∆R2' MK∆T1 (?64 64⍴0)
∆scan∆053_TEST←'scan∆R2' MK∆T1 ((?64 64⍴0)+0j1+?64 64⍴0)
∆scan∆054_TEST←'scan∆R2' MK∆T1 (?3 3 3⍴2)
∆scan∆055_TEST←'scan∆R2' MK∆T1 ((2*8)+1+?3 3 3⍴2)
∆scan∆056_TEST←'scan∆R2' MK∆T1 ((2*16)+1+?3 3 3⍴2)
∆scan∆057_TEST←'scan∆R2' MK∆T1 (?3 3 3⍴0)
∆scan∆058_TEST←'scan∆R2' MK∆T1 ((?3 3 3⍴0)+0j1+?3 3 3⍴0)
∆scan∆059_TEST←'scan∆R2' MK∆T1 (?16 16 16⍴2)
∆scan∆060_TEST←'scan∆R2' MK∆T1 ((2*8)+1+?16 16 16⍴2)
∆scan∆061_TEST←'scan∆R2' MK∆T1 ((2*16)+1+?16 16 16⍴2)
∆scan∆062_TEST←'scan∆R2' MK∆T1 (?16 16 16⍴0)
∆scan∆063_TEST←'scan∆R2' MK∆T1 ((?16 16 16⍴0)+0j1+?16 16 16⍴0)
∆scan∆064_TEST←'scan∆min' MK∆T1 (⍬⍴1)
∆scan∆065_TEST←'scan∆min' MK∆T1 (?5⍴2)
∆scan∆066_TEST←'scan∆min' MK∆T1 (5⍴⍳5)
∆scan∆067_TEST←'scan∆min' MK∆T1 ((2*16)+?5⍴128)
∆scan∆068_TEST←'scan∆min' MK∆T1 (?5⍴0)
∆scan∆069_TEST←'scan∆min' MK∆T1 (?2048⍴2)
∆scan∆070_TEST←'scan∆min' MK∆T1 (2048⍴⍳5)
∆scan∆071_TEST←'scan∆min' MK∆T1 ((2*16)+?2048⍴128)
∆scan∆072_TEST←'scan∆min' MK∆T1 (?2048⍴0)
∆scan∆073_TEST←'scan∆min' MK∆T1 (?3 3⍴2)
∆scan∆074_TEST←'scan∆min' MK∆T1 ((2*8)+?3 3⍴128)
∆scan∆075_TEST←'scan∆min' MK∆T1 ((2*16)+?3 3⍴128)
∆scan∆076_TEST←'scan∆min' MK∆T1 (?3 3⍴0)
∆scan∆077_TEST←'scan∆min' MK∆T1 (?64 64⍴2)
∆scan∆078_TEST←'scan∆min' MK∆T1 ((2*8)+?64 64⍴128)
∆scan∆079_TEST←'scan∆min' MK∆T1 ((2*16)+?64 64⍴128)
∆scan∆080_TEST←'scan∆min' MK∆T1 (?64 64⍴0)
∆scan∆081_TEST←'scan∆min' MK∆T1 (?3 3 3⍴2)
∆scan∆082_TEST←'scan∆min' MK∆T1 ((2*8)+?3 3 3⍴128)
∆scan∆083_TEST←'scan∆min' MK∆T1 ((2*16)+?3 3 3⍴128)
∆scan∆084_TEST←'scan∆min' MK∆T1 (?3 3 3⍴0)
∆scan∆085_TEST←'scan∆min' MK∆T1 (?16 16 16⍴2)
∆scan∆086_TEST←'scan∆min' MK∆T1 ((2*8)+?16 16 16⍴128)
∆scan∆087_TEST←'scan∆min' MK∆T1 ((2*16)+?16 16 16⍴128)
∆scan∆088_TEST←'scan∆min' MK∆T1 (?16 16 16⍴0)
∆scan∆089_TEST←'scan∆max' MK∆T1 (⍬⍴1)
∆scan∆090_TEST←'scan∆max' MK∆T1 (?5⍴2)
∆scan∆091_TEST←'scan∆max' MK∆T1 (5⍴⍳5)
∆scan∆092_TEST←'scan∆max' MK∆T1 ((2*16)+?5⍴128)
∆scan∆093_TEST←'scan∆max' MK∆T1 (?5⍴0)
∆scan∆094_TEST←'scan∆max' MK∆T1 (?2048⍴2)
∆scan∆095_TEST←'scan∆max' MK∆T1 (2048⍴⍳5)
∆scan∆096_TEST←'scan∆max' MK∆T1 ((2*16)+?2048⍴128)
∆scan∆097_TEST←'scan∆max' MK∆T1 (?2048⍴0)
∆scan∆098_TEST←'scan∆max' MK∆T1 (?3 3⍴2)
∆scan∆099_TEST←'scan∆max' MK∆T1 ((2*8)+?3 3⍴128)
∆scan∆100_TEST←'scan∆max' MK∆T1 ((2*16)+?3 3⍴128)
∆scan∆101_TEST←'scan∆max' MK∆T1 (?3 3⍴0)
∆scan∆102_TEST←'scan∆max' MK∆T1 (?64 64⍴2)
∆scan∆103_TEST←'scan∆max' MK∆T1 ((2*8)+?64 64⍴128)
∆scan∆104_TEST←'scan∆max' MK∆T1 ((2*16)+?64 64⍴128)
∆scan∆105_TEST←'scan∆max' MK∆T1 (?64 64⍴0)
∆scan∆106_TEST←'scan∆max' MK∆T1 (?3 3 3⍴2)
∆scan∆107_TEST←'scan∆max' MK∆T1 ((2*8)+?3 3 3⍴128)
∆scan∆108_TEST←'scan∆max' MK∆T1 ((2*16)+?3 3 3⍴128)
∆scan∆109_TEST←'scan∆max' MK∆T1 (?3 3 3⍴0)
∆scan∆110_TEST←'scan∆max' MK∆T1 (?16 16 16⍴2)
∆scan∆111_TEST←'scan∆max' MK∆T1 ((2*8)+?16 16 16⍴128)
∆scan∆112_TEST←'scan∆max' MK∆T1 ((2*16)+?16 16 16⍴128)
∆scan∆113_TEST←'scan∆max' MK∆T1 (?16 16 16⍴0)
∆scan∆114_TEST←'scan∆and' MK∆T1 (⍬⍴1)
∆scan∆115_TEST←'scan∆and' MK∆T1 (?5⍴2)
∆scan∆116_TEST←'scan∆and' MK∆T1 (?2048⍴2)
∆scan∆117_TEST←'scan∆and' MK∆T1 (?3 3⍴2)
∆scan∆118_TEST←'scan∆and' MK∆T1 (?64 64⍴2)
∆scan∆119_TEST←'scan∆and' MK∆T1 (?3 3 3⍴2)
∆scan∆120_TEST←'scan∆and' MK∆T1 (?16 16 16⍴2)
∆scan∆121_TEST←'scan∆lor' MK∆T1 (⍬⍴1)
∆scan∆122_TEST←'scan∆lor' MK∆T1 (?5⍴2)
∆scan∆123_TEST←'scan∆lor' MK∆T1 (?2048⍴2)
∆scan∆124_TEST←'scan∆lor' MK∆T1 (?3 3⍴2)
∆scan∆125_TEST←'scan∆lor' MK∆T1 (?64 64⍴2)
∆scan∆126_TEST←'scan∆lor' MK∆T1 (?3 3 3⍴2)
∆scan∆127_TEST←'scan∆lor' MK∆T1 (?16 16 16⍴2)
∆scan∆128_TEST←'scan∆xor' MK∆T1 (⍬⍴1)
∆scan∆129_TEST←'scan∆xor' MK∆T1 (?5⍴2)
∆scan∆130_TEST←'scan∆xor' MK∆T1 (?2048⍴2)
∆scan∆131_TEST←'scan∆xor' MK∆T1 (?3 3⍴2)
∆scan∆132_TEST←'scan∆xor' MK∆T1 (?64 64⍴2)
∆scan∆133_TEST←'scan∆xor' MK∆T1 (?3 3 3⍴2)
∆scan∆134_TEST←'scan∆xor' MK∆T1 (?16 16 16⍴2)
∆scan∆135_TEST←'scan∆R3' MK∆T1 (⍬⍴3)
∆scan∆136_TEST←'scan∆R2' MK∆T1 (⍬)
∆scan∆137_TEST←'scan∆R1' MK∆T1 (⍬)
∆scan∆138_TEST←'scan∆R3' MK∆T1 (⍬⍴1)
∆scan∆139_TEST←'scan∆R3' MK∆T1 (5⍴⍳5)
∆scan∆140_TEST←'scan∆R3' MK∆T1 (3 3⍴⍳9)
∆scan∆141_TEST←'scan∆R4' MK∆T1 ((2 10)⍴1)
∆scan∆142_TEST←'scan∆R4' MK∆T1 ((2 10)⍴5)
∆scan∆143_TEST←'scan∆R1' MK∆T1 ((2 10)⍴1)
∆scan∆144_TEST←'scan∆R4' MK∆T1 ((2 10)⍴1 0)
∆scan∆145_TEST←'scan∆R4' MK∆T1 ((2 10)⍴5 0)
∆scan∆146_TEST←'scan∆R4' MK∆T1 (⍬⍴1)
∆scan∆147_TEST←'scan∆R4' MK∆T1 (5⍴⍳5)
∆scan∆148_TEST←'scan∆R4' MK∆T1 (3 3⍴⍳9)
∆scan∆149_TEST←'scan∆R3' MK∆T1 (3 0⍴⍳9)
∆scan∆150_TEST←'scan∆R4' MK∆T1 (3 0⍴⍳9)
∆scan∆151_TEST←'scan∆R3' MK∆T1 (3 1⍴⍳9)
∆scan∆152_TEST←'scan∆R4' MK∆T1 (3 1⍴⍳9)

∆∆∆_TEST←{#.UT.expect←,¨0 0 ⋄ _←#.⎕EX¨cn tn ⋄ #.⎕NC¨cn tn}

:EndNamespace